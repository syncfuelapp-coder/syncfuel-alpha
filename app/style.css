// --- SYNCFUEL ALPHA v2 ---
const state = JSON.parse(localStorage.getItem('syncfuel-state')) || {
  hydration: { now: 0.84, goal: 2 },
  calories: 0,
  lastUpdate: Date.now()
};

const hydrationNow = document.getElementById('hydrationNow');
const hydrationGoal = document.getElementById('hydrationGoal');
const hydrationFill = document.getElementById('hydrationFill');
const fuelAlert = document.getElementById('fuelAlert');

// --- Hydration update ---
function renderHydration() {
  hydrationNow.textContent = state.hydration.now.toFixed(2);
  const pct = Math.min(100, (state.hydration.now / state.hydration.goal) * 100);
  hydrationFill.style.width = pct + "%";
}

// --- Smart Fuel logic ---
function calcFuelAlert() {
  const pct = (state.hydration.now / state.hydration.goal) * 100;
  const hoursSince = (Date.now() - state.lastUpdate) / 3600000;
  let msg = "Fuel Good üîã";

  if (pct < 50 || hoursSince > 4) msg = "Refuel Soon ‚ö†Ô∏è";
  if (pct < 30 || hoursSince > 6) msg = "Low Fuel ‚õΩ";

  fuelAlert.textContent = msg;
}

// --- Save state locally ---
function saveState() {
  localStorage.setItem('syncfuel-state', JSON.stringify(state));
}

// --- Add hydration ---
document.querySelectorAll('[data-h2o]').forEach(btn => {
  btn.onclick = () => {
    state.hydration.now += parseFloat(btn.dataset.h2o);
    state.lastUpdate = Date.now();
    renderHydration();
    calcFuelAlert();
    saveState();
  };
});

function init() {
  renderHydration();
  calcFuelAlert();
}
init();
